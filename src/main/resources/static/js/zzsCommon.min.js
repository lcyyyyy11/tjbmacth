var SelectValues="";var sOldValues="";var jqOldValues="";var isNullOrEmpty=function(a){return(a===undefined||a===null||a==="")};String.prototype.ltrim=function(){return this.replace(/^\s*/g,"")};String.prototype.rtrim=function(){return this.replace(/\s*$/g,"")};String.prototype.ctrim=function(){return this.replace(/\s/g,"")};String.prototype.trim=function(){return this.replace(/(^\s*)|(\s*$)/g,"")};String.prototype.replaceAll=function(b,a){var d=new RegExp(b,"gm");var c=this;while(c.indexOf(b)>-1){c=c.replace(d,a)}return c};String.prototype.startWith=function(a){return(new RegExp("^"+a)).test(this)};String.prototype.endWith=function(a){return(new RegExp(a+"$")).test(this)};String.prototype.getExtension=function(){var a=this.match(/\.([^\.]+)$/i);return(a==null?"":a[1])};String.prototype.reverse=function(){var a=new Array();for(var b=this.length-1;b>-1;b--){a.push(this.charAt(b))}return a.join("").toString()};String.prototype.left=function(b,g){if(!/\d+/.test(b)){return(this)}var f=this.substr(0,b);if(!g){return f}var c=0,d="";for(var e=0;e<f.length;e++){if(f.charCodeAt(e)>255){c+=2}else{c++}if(c>b){return d}d+=f.charAt(e)}return f};String.prototype.right=function(a,b){return this.reverse().left(a,b).reverse()};function isChinese(b){var a=/^[\u4E00-\u9FA5]+$/;if(a.test(b)){return true}return false}function isNumber(a){return !isNaN(parseFloat(a))&&isFinite(a)}function ParseJSONDate(c){var b;if(typeof c==="string"){b=/\/Date\((\d*)\)\//.exec(c);if(b){return new Date(+b[1])}}return c}function ParseJSONDateS(a){return new Date(parseInt(a.substr(6)))}function clearListCookies(){var b=document.cookie.split(";");for(var a=0;a<b.length;a++){var c=b[a].split("=");document.cookie=c[0]+"=;expires=Thu, 21 Sep 1979 00:00:01 UTC;"}}function getUrlParameter(b){var a=window.location.href;b=b.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var c=window.location.search.match(new RegExp("[?&]"+b+"=([^&]*)(&?)","i"));return c?decodeURIComponent(c[1].replace(/\+/g," ")):c}function num(b){var a=document.getElementById(b);if(/\D/.test(a.value)){RunPop("只能输入数字");a.value=""}}function GetOptions(d,c,a){var b=new XMLHttpRequest();b.open("GET","/ps/GetOptions?gType="+d,false);b.onreadystatechange=function(){if(b.readyState==4){if(b.status==200){fillOption(b.responseText,c,a)}else{alert("err:"+b.status)}}};b.setRequestHeader("Content-Type","application/x-www-form-urlencoded");b.send()}function GetSingleVal(d,b,a){var c=new XMLHttpRequest();c.open("GET","/searchSingleVal?gType="+d,b);c.onreadystatechange=function(){if(c.readyState==4){if(c.status==200){if(isFunction(a)){a(c.responseText)}}else{a(c.responseText)}}};c.setRequestHeader("Content-Type","application/x-www-form-urlencoded");c.send()}function fillOption(c,j,f){var h=c.split(";");var b=document.getElementById(j);for(var d=0;d<h.length;d++){try{var a=h[d].split(":");b.options.add(new Option(a[1],a[0]))}catch(g){continue}}if(isFunction(f)){f()}}$.fn.addSmartList=function(a,d){var h=this;var k=$(h).val();var l="";var m=$(h).attr("id")+"_dl";if(k.length==0){$("#"+m).remove()}else{if(k.length>=d&&k.charCodeAt(0)>255){$.ajax({url:"/GetOptions",type:"POST",async:true,data:{gType:a,sFltStr:k},success:function(e){l=e}});if(l!=""){$("#"+m).remove();var n=$("<datalist/>",{id:m});var c=l.split(";");for(var g=0;g<c.length;g++){try{var f=c[g].split(":");var b=$("<option></option>").attr("value",f[1]);$(n).append(b)}catch(j){continue}}$(n).appendTo("body");$("#"+$(h).attr("id")).attr("list",m)}}}};function getjQGridOption(b){var a="";$.ajax({url:"/ps/GetOptions?gType="+b,type:"GET",dataType:"text",async:false,success:function(c){a=c},error:function(c){}});if(a!=""){return a}}function GetSelectValues(a){var b=new XMLHttpRequest();b.open("Post","/GetSelectValueStr",true);b.onreadystatechange=function(){if(b.readyState==4){if(b.status==200){SelectValues=b.responseText}else{alert("err:"+b.status)}}};b.setRequestHeader("Content-Type","application/x-www-form-urlencoded");b.send(a)}function getOption(c){var b=document.getElementById(c);var a=b.selectedIndex;return{val:b.options[a].value,index:b.selectedIndex}}function getCookie(d){var b=d+"=";var a=document.cookie.split(";");for(var e=0;e<a.length;e++){var f=a[e];while(f.charAt(0)==" "){f=f.substring(1)}if(f.indexOf(b)!=-1){return decodeURI(f.substring(b.length,f.length))}}return""}function CheckMail(a){var b=/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;if(b.test(a)){return true}else{return false}}function idCardNo(e){var b={11:"北京",12:"天津",13:"河北",14:"山西",15:"内蒙古",21:"辽宁",22:"吉林",23:"黑龙江",31:"上海",32:"江苏",33:"浙江",34:"安徽",35:"福建",36:"江西",37:"山东",41:"河南",42:"湖北",43:"湖南",44:"广东",45:"广西",46:"海南",50:"重庆",51:"四川",52:"贵州",53:"云南",54:"西藏",61:"陕西",62:"甘肃",63:"青海",64:"宁夏",65:"新疆",71:"台湾",81:"香港",82:"澳门",91:"国外"};if(e===""){return false}if(d(e)===false){return false}if(g(e)===false){return false}if(c(e)===false){return false}if(a(e)===false){return false}return true;function d(i){var h=/(^\d{15}$)|(^\d{17}(\d|X)$)/;if(h.test(i)===false){return false}return true}function g(i){var h=i.substr(0,2);if(b[h]==undefined){return false}return true}function c(h){var i=h.length;if(i=="15"){var p=/^(\d{6})(\d{2})(\d{2})(\d{2})(\d{3})$/;var k=h.match(p);var l=k[2];var j=k[3];var m=k[4];var n=new Date("19"+l+"/"+j+"/"+m);return f("19"+l,j,m,n)}if(i=="18"){var o=/^(\d{6})(\d{4})(\d{2})(\d{2})(\d{3})([0-9]|X)$/;var k=h.match(o);var l=k[2];var j=k[3];var m=k[4];var n=new Date(l+"/"+j+"/"+m);return f(l,j,m,n)}return false}function f(k,n,h,l){var i=new Date();var j=i.getFullYear();if(l.getFullYear()==k&&(l.getMonth()+1)==n&&l.getDate()==h){var m=j-k;if(m>=0&&m<=130){return true}return false}return false}function a(o){o=changeFivteenToEighteen(o);var j=o.length;if(j=="18"){var l=new Array(7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2);var h=new Array("1","0","X","9","8","7","6","5","4","3","2");var n=0,m,k;for(m=0;m<17;m++){n+=o.substr(m,1)*l[m]}k=h[n%11];if(k==o.substr(17,1)){return true}return false}return false}}function changeFivteenToEighteen(e){if(e.length=="15"){var b=new Array(7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2);var a=new Array("1","0","X","9","8","7","6","5","4","3","2");var d=0,c;e=e.substr(0,6)+"19"+e.substr(6,e.length-6);for(c=0;c<17;c++){d+=e.substr(c,1)*b[c]}e+=a[d%11];return e}return e}function RunPop(t,d,s,j,b,l,n,g){if(d==null&&s==null){s=t;t=""}if(b==null&&l==null){b=0.4;l=0.15}var u="zzsModal";var e="zzsPopConfirm";if(g!=null){u=g;e=g.trim()+"Confirm"}if(j==null){j="提示"}var k=(j=="成功"?"success":(j=="警告"?"warning":(j=="危险"?"danger":"info")));var q=null,c="false",h="",f="";var r=Math.ceil(b*$(document).width());var i=Math.ceil(l*$(document).height()-45);if(r<100){r=450}if(i<50){i=200}var p=Math.ceil((1-b)*$(document).width()/2);var a=Math.ceil(((1-l)*$(document).height()-10)/2);var m="";if(d!=null&&d!=""){q="<iframe src="+d+' seamless frameborder="no" border="0" marginwidth="0" marginheight="0" scrolling="yes" allowTransparency="true" style="width:100%;height:100%;" ></iframe>';c="true";h='<div class="modal-header" style="padding:0 10px;">';f=('<h6 class="modal-title">'+t+"</h6></div>");i=Math.ceil(l*$(document).height()-17)}else{a=Math.ceil(((1-l)*$(document).height()-10)/4);q='<div class="alert alert-'+k+'">';q=q+"<strong>"+j+"!</strong> "+s+"</div>";h='<div class="modal-header">';f=('<h4 class="modal-title">'+t+"</h4></div>");m='<div class="modal-footer">';m+="<button id="+e+' type="button" class="btn btn-primary">确定</button>';m+='<button type="button" class="btn btn-primary" data-dismiss="modal">取消</button></div>'}var o="<div id="+u+' class="modal fade" data-backdrop='+c+' role="dialog">';o+='<div class="modal-dialog" style="margin:0 auto;position:absolute;top:'+a+"px;left:"+p+"px;width:"+r+'px;">';o+='<div class="modal-content">'+h;o+='<button type="button" class="close" data-dismiss="modal">&times;</button>';o+=f;o+=('<div class="modal-body" style="padding:0;margin:0;height:'+i+"px; max-height:"+i+'px;">');o+=q;o+="</div>";o+=m;o+="</div></div></div>";$(o).appendTo("body");$("#"+u).modal();$("#"+e).on("click",function(){$("#"+u).modal("hide");try{n()}catch(v){}});$("#"+u).on("hidden.bs.modal",function(){$("#"+u).remove();if(d!=null&&d!=""){try{n()}catch(v){}}})}function RunUpload(k,j,h,e,a,b,c){var d="";var i=Math.ceil(b*$(document).width());var g=null,f=null;if(j==""){f="上传..."}else{f=j}if(e==true||e=="true"){sBody='<input type="file" id="zzsFileUp" multiple="multiple" accept='+a+' class="btn btn-info" style="width:'+Math.floor(i*0.94)+'px;"/>'}else{sBody='<input type="file" id="zzsFileUp" accept='+a+' class="btn btn-info"/>'}sBody+='<div id="zzsFileHolder"></div>';var m='<div id="zzsUploadModal" class="modal fade" data-backdrop="false" role="dialog">';m+='<div class="modal-dialog" style="width:'+i+'px;">';m+='<div class="modal-content"><div class="modal-header">';m+='<button type="button" class="close" data-dismiss="modal">&times;</button>';m+=('<h4 class="modal-title">'+k+"</h4></div>");m+=('<div class="modal-body" style="height:170px; max-height:170px;">');m+=sBody;m+='<div class="modal-footer">';m+='<div id="zzsUpProgressBar" class="progress-bar" role="progressbar" aria-valuenow="50" aria-valuemin="0" aria-valuemax="100" style="width:0%;height:20px;">0%</div><br/>';m+='<button type="button" class="btn btn-primary" id="zzsDoUpload" style="margin-top:5px;">'+f+"</button></div>";m+="</div></div></div></div>";$(m).appendTo("body");$("#zzsFileUp").on("click",function(){$("#zzsDoUpload").attr("disabled",false)});$("#zzsFileUp").on("change",function(){$("#zzsDoUpload").attr("disabled",false);$("#zzsFileHolder").html("<br/>");$("#zzsUpProgressBar").css("width","0%");var p="";g=this.files;for(var o=0;o<g.length;o++){var n=g[o];if(o%2==0){if(o==g.length-1){p+='<span style="position:absolute;left:5%;"> '+n.name+" (大小: "+n.size+") </span><br/><br/>"}else{p+='<span style="position:absolute;left:5%;"> '+n.name+" (大小: "+n.size+") </span>"}}else{p+='<span style="position:absolute;left:55%;"> '+n.name+" (大小: "+n.size+") </span><br/><br/>"}}$("#zzsUploadModal .modal-body").css("height",Math.ceil(this.files.length/2)*40+170+"px");$("#zzsUploadModal .modal-body").css("max-height",Math.ceil(this.files.length/2)*40+170+"px");$(p).appendTo("#zzsFileHolder")});$("#zzsDoUpload").on("click",function(){$(this).attr("disabled",true);if($("#zzsFileHolder").find("span").length===0){RunPop("提示信息","","请选择上传的文件！","警告",0.3,0.2,"","UpLoadFileEmptyMsg");$("#UpLoadFileEmptyMsg .modal-dialog").css({top:"150px",left:(window.screen.availWidth/3)+"px"});$("#UpLoadFileEmptyMsg .modal-body").css("height",window.screen.availHeight*0.2);return}for(var n=0;n<g.length;n++){l(g[n],n)}});$("#zzsUploadModal").modal();$("#zzsUploadModal").on("hidden.bs.modal",function(){$("#zzsUploadModal").remove();try{c(d)}catch(n){}});function l(p,n){var o=new FormData();o.append("upload",1);o.append("file",p);$.ajax({url:h,type:"POST",async:true,processData:false,contentType:false,data:o,xhr:function(){var q=new XMLHttpRequest();q.upload.addEventListener("progress",function(t){var s=new Number(t.loaded/t.total);var r=(s*100).toFixed(2)+"%";$("#zzsUpProgressBar").css("width",r);$("#zzsUpProgressBar").html(r)});return q},success:function(q){d=q;++n;$("#zzsUpProgressBar").css("width",n/g.length*100+"%");if(n<g.length){$("#zzsUpProgressBar").html(n/g.length*100+"%")}else{$("#zzsUpProgressBar").html(n/g.length*100+"%  上传成功!");$("#zzsUploadModal").modal("hide")}}})}}function RunUploadFile_Size(k,j,h,e,a,b,c,n){var d="";var i=Math.ceil(b*$(document).width());var g=null,f=null;if(j==""){f="上传..."}else{f=j}if(e==true||e=="true"){sBody='<input type="file" id="zzsFileUp" multiple="multiple" accept='+a+' class="btn btn-info" style="width:'+Math.floor(i*0.94)+'px;"/>'}else{sBody='<input type="file" id="zzsFileUp" accept='+a+' class="btn btn-info"/>'}sBody+='<div id="zzsFileHolder"></div>';var m='<div id="zzsUploadModal" class="modal fade" data-backdrop="false" role="dialog">';m+='<div class="modal-dialog" style="width:'+i+'px;">';m+='<div class="modal-content"><div class="modal-header">';m+='<button type="button" class="close" data-dismiss="modal">&times;</button>';m+=('<h4 class="modal-title">'+k+"</h4></div>");m+=('<div class="modal-body" style="height:170px; max-height:170px;">');m+=sBody;m+='<div class="modal-footer">';m+='<div id="zzsUpProgressBar" class="progress-bar" role="progressbar" aria-valuenow="50" aria-valuemin="0" aria-valuemax="100" style="width:0%;height:20px;">0%</div><br/>';m+='<button type="button" class="btn btn-primary" id="zzsDoUpload" style="margin-top:5px;">'+f+"</button></div>";m+="</div></div></div></div>";$(m).appendTo("body");$("#zzsFileUp").on("click",function(){$("#zzsDoUpload").attr("disabled",false)});$("#zzsFileUp").on("change",function(){$("#zzsDoUpload").attr("disabled",false);$("#zzsFileHolder").html("<br/>");$("#zzsUpProgressBar").css("width","0%");var q="";g=this.files;for(var p=0;p<g.length;p++){var o=g[p];if(p%2==0){if(p==g.length-1){q+='<span style="position:absolute;left:5%;"> '+o.name+" (大小: "+o.size+") </span><br/><br/>"}else{q+='<span style="position:absolute;left:5%;"> '+o.name+" (大小: "+o.size+") </span>"}}else{q+='<span style="position:absolute;left:55%;"> '+o.name+" (大小: "+o.size+") </span><br/><br/>"}}$("#zzsUploadModal .modal-body").css("height",Math.ceil(this.files.length/2)*40+170+"px");$("#zzsUploadModal .modal-body").css("max-height",Math.ceil(this.files.length/2)*40+170+"px");$(q).appendTo("#zzsFileHolder")});$("#zzsDoUpload").on("click",function(){$(this).attr("disabled",true);if($("#zzsFileHolder").find("span").length===0){RunPop("提示信息","","请选择上传的文件！","警告",0.3,0.2,"","UpLoadFileEmptyMsg");$("#UpLoadFileEmptyMsg .modal-dialog").css({top:"150px",left:(window.screen.availWidth/3)+"px"});$("#UpLoadFileEmptyMsg .modal-body").css("height",window.screen.availHeight*0.2);$("body").css("padding-right","0px");return}var o=parseInt(parseInt(n)*1024*1024);for(var p=0;p<g.length;p++){if(parseInt(g[p].size)>o){RunPop("提示信息","","上传文件的大小不能超过"+n+"M!","警告",0.3,0.2,"","UpLoadFileFailMsg");$("#UpLoadFileFailMsg .modal-dialog").css({top:"150px",left:(window.screen.availWidth/3)+"px"});$("#UpLoadFileFailMsg .modal-body").css("height",window.screen.availHeight*0.2);$("body").css("padding-right","0px");return}l(g[p],p)}});$("#zzsUploadModal").modal();$("#zzsUploadModal").on("hidden.bs.modal",function(){$("#zzsUploadModal").remove();try{c(d)}catch(o){}});function l(q,o){var p=new FormData();p.append("upload",1);p.append("file",q);$.ajax({url:h,type:"POST",async:true,processData:false,contentType:false,data:p,xhr:function(){var r=new XMLHttpRequest();r.upload.addEventListener("progress",function(u){var t=new Number(u.loaded/u.total);var s=(t*100).toFixed(2)+"%";$("#zzsUpProgressBar").css("width",s);$("#zzsUpProgressBar").html(s)});return r},success:function(r){d=r;++o;if(o<g.length){$("#zzsUpProgressBar").html(o/g.length*100+"%")}else{$("#zzsUpProgressBar").html(o/g.length*100+"%  上传成功!");$("#zzsUploadModal").modal("hide")}}})}}$.fn.accessFormData=function(f,e,b){var d=this;var a="oper="+oper+"&";if(oper=="add"){a=a+d.serialize()}else{if(oper=="edit"){a=a+d.serialize()+sOldValues}}var c=f.indexOf("?")>0?(f+"&"+e):(f+"?"+e);$.ajax({url:c,type:"POST",data:a,dataType:"text",success:function(h){if(oper=="select"){d.setFormValue($.parseJSON(h).data,b)}else{if(oper=="edit"){try{b($.parseJSON(h).data)}catch(g){}}else{if(oper=="add"){try{b($.parseJSON(h).data)}catch(g){}}}}oper="edit"}})};$.fn.setFormValue=function(b,a){sOldValues="";var d=this;$.each(b,function(e,h){var f=d.find('input[name="'+e+'"],textarea[name="'+e+'"],select[name="'+e+'"]'),g=f.attr("type");switch(g){case"checkbox":if(f.val()==h){f.prop("checked",true)}else{f.prop("checked",false)}break;case"radio":f.filter('[value="'+h+'"]').prop("checked",true);f.filter('[value!="'+h+'"]').prop("checked",false);break;default:f.val(h)}if(typeof(f.attr("data-mark"))!="undefined"){sOldValues+="&"+e+"_old="+encodeURI(h)+"-zzs-"+encodeURI(f.attr("data-mark"))}});try{a(b)}catch(c){}};$.fn.saveOldValues=function(c){var d=this;jqOldValues="";var a=this.jqGrid("getGridParam","colModel");for(var b=0;b<a.length;b++){if(a[b].name!="rn"&&a[b].name!="cb"&&a[b].name!="subgrid"&&a[b].name!="opera"){jqOldValues+="&"+a[b].name+"_old="+this.jqGrid("getCell",c,a[b].name).replace(/&|=/g,"")+"-zzs-"+a[b].label.replace(/&|=/g,"")}}};Date.prototype.ToString=function(b){var c={"M+":this.getMonth()+1,"d+":this.getDate(),"H+":this.getHours(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};if(/(y+)/.test(b)){b=b.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))}for(var a in c){if(new RegExp("("+a+")").test(b)){b=b.replace(RegExp.$1,(RegExp.$1.length==1)?(c[a]):(("00"+c[a]).substr((""+c[a]).length)))}}return b};var timer;$("#search_cells").on("keyup",function(){var a=this;if(timer){clearTimeout(timer)}timer=setTimeout(function(){$("#Grid").jqGrid("filterInput",a.value)},0)});function signSelected(b,a,c){var d="";if(parseInt(b)==1){d+="<span class=\"glyphicon glyphicon-check\"  style='color: #00bf00'></span>"}else{d+='<input type="checkbox" disabled="true" value="0">'}return d}$.fn.filterByText=function(a,c,b){return this.each(function(){var d=this;var e=[];$(d).find("option").each(function(){e.push({value:$(this).val(),text:$(this).text()})});$(d).data("options",e);$(a).bind("change keyup",function(){var f=$(d).empty().data("options");var g=$.trim($(this).val());var h=new RegExp(g,"gi");$.each(f,function(j){var k=f[j];if(k.text.match(h)!==null){$(d).append($("<option>").text(k.text).val(k.value))}});if(c===true&&$(d).children().length===1){$(d).children().get(0).selected=true}if($.isFunction(b)&&$(d).val()){b()}})})};$(".panel-group .in").prev().addClass("panelCur");$(".panel-group .panel-heading  a").on("click",function(){$(".panel-group .panel-heading").removeClass("panelCur");$(this).parents(".panel-heading").addClass("panelCur")});function nonNullAndEmpty(a){return(a!=undefined&&a!=null&&a!="")}function compareDateEqual(b,a){b=new Date(b);a=new Date(a);if(b.getFullYear()<a.getFullYear()){return true}else{if(b.getFullYear()>a.getFullYear()){return false}else{if(b.getFullYear()===a.getFullYear()){if(b.getMonth()<a.getMonth()){return true}else{if(b.getMonth()>a.getMonth()){return false}else{if(b.getMonth()===a.getMonth()){if(b.getDate()<a.getDate()){return true}else{if(b.getDate()>a.getDate()){return false}else{if(b.getDate()===a.getDate()){return true}}}}}}}}}}function compareDate(b,a){b=new Date(b);a=new Date(a);if(b.getFullYear()<a.getFullYear()){return true}else{if(b.getFullYear()>a.getFullYear()){return false}else{if(b.getFullYear()===a.getFullYear()){if(b.getMonth()<a.getMonth()){return true}else{if(b.getMonth()>a.getMonth()){return false}else{if(b.getMonth()===a.getMonth()){if(b.getDate()<a.getDate()){return true}else{if(b.getDate()>a.getDate()){return false}else{if(b.getDate()===a.getDate()){return false}}}}}}}}}}function RunUploadVideo_Size(l,k,i,f,a,b,c,o){var e=null;var d="";var j=Math.ceil(b*$(document).width());var h=null,g=null;if(k==""){g="上传..."}else{g=k}if(f==true||f=="true"){sBody='<input type="file" id="zzsFileUp" multiple="multiple" accept='+a+' class="btn btn-info" style="width:'+Math.floor(j*0.94)+'px;"/>'}else{sBody='<input type="file" id="zzsFileUp" accept='+a+' class="btn btn-info"/>'}sBody+='<div id="zzsFileHolder"></div>';var n='<div id="zzsUploadModal" class="modal fade" data-backdrop="false" role="dialog">';n+='<div class="modal-dialog" style="width:'+j+'px;">';n+='<div class="modal-content"><div class="modal-header">';n+='<button type="button" class="close" data-dismiss="modal">&times;</button>';n+=('<h4 class="modal-title">'+l+"</h4></div>");n+=('<div class="modal-body" style="height:170px; max-height:170px;">');n+=sBody;n+='<div class="modal-footer">';n+='<div id="zzsUpProgressBar" class="progress-bar" role="progressbar" aria-valuenow="50" aria-valuemin="0" aria-valuemax="100" style="width:0%;height:20px;">0%</div><br/>';n+='<button type="button" class="btn btn-primary" id="zzsDoUpload" style="margin-top:5px;">'+g+"</button></div>";n+="</div></div></div></div>";$(n).appendTo("body");$("#zzsFileUp").on("click",function(){$("#zzsDoUpload").attr("disabled",false)});$("#zzsFileUp").on("change",function(){try{e.abort()}catch(w){}$("#zzsDoUpload").attr("disabled",false);$("#zzsFileHolder").html("<br/>");$("#zzsUpProgressBar").css("width","0%");var v="";h=this.files;for(var u=0;u<h.length;u++){var t=h[u];try{var s=MP4Box.createFile();if(t){var p=new FileReader();var q=p.readAsArrayBuffer(t);p.onload=function(y){var x=y.target.result;x.fileStart=0;s.appendBuffer(x)}}var r=0;s.onReady=function(A){var z=A.mime;var y=z.match(/codecs="(\S*),/)[1];if(y.indexOf("avc")===-1){r=1}if(r){$("#zzsUploadModal").modal("hide");var x='抱歉，您提供的视频由于编码格式问题无法在线播放以及在线评审。推荐您从以下链接下载转换工具，转换为浏览器识别的H.264编码格式(转换器默认的输出格式)的mp4视频。请上传转换后的mp4视频。谢谢！<br/><a title="点击下载转换工具，请耐心等待" style="color: red;" target="_blank" href="https://www.any-video-converter.com/cn/any-video-converter-free.php">转换工具链接</a>';RunPop("提示信息","",x,"提示",0.35,0.2,"","UpLoadFileErrorMsg");$("#UpLoadFileErrorMsg .modal-dialog").css({top:"100px",left:(window.screen.availWidth/3)+"px"});$("#UpLoadFileErrorMsg .modal-body").css("height",window.screen.availHeight*0.2);$("body").css("padding-right","0px")}else{$("#zzsDoUpload").attr("disabled",false)}}}catch(w){}if(u%2==0){if(u==h.length-1){v+='<span style="position:absolute;left:5%;"> '+t.name+" (大小: "+t.size+") </span><br/><br/>"}else{v+='<span style="position:absolute;left:5%;"> '+t.name+" (大小: "+t.size+") </span>"}}else{v+='<span style="position:absolute;left:55%;"> '+t.name+" (大小: "+t.size+") </span><br/><br/>"}}$("#zzsUploadModal .modal-body").css("height",Math.ceil(this.files.length/2)*40+170+"px");$("#zzsUploadModal .modal-body").css("max-height",Math.ceil(this.files.length/2)*40+170+"px");$(v).appendTo("#zzsFileHolder")});$("#zzsDoUpload").on("click",function(){$(this).attr("disabled",true);if($("#zzsFileHolder").find("span").length===0){RunPop("提示信息","","请选择上传的文件！","警告",0.3,0.2,"","UpLoadFileEmptyMsg");$("#UpLoadFileEmptyMsg .modal-dialog").css({top:"150px",left:(window.screen.availWidth/3)+"px"});$("#UpLoadFileEmptyMsg .modal-body").css("height",window.screen.availHeight*0.2);$("body").css("padding-right","0px");return}var p=o*1024*1024;if(isNullOrEmpty(h)){return}for(var q=0;q<h.length;q++){if(h[q].size>p){$("#zzsUploadModal").remove();RunPop("提示信息","","上传文件的大小不能超过"+o+"M!","警告",0.4,0.2,"","UpLoadMaxSizeMsg");$("#UpLoadFileFailMsg .modal-dialog").css({top:"150px",left:(window.screen.availWidth/3)+"px"});$("#UpLoadFileFailMsg .modal-body").css("height",window.screen.availHeight*0.2);$("body").css("padding-right","0px");return}m(h[q],q)}});$("#zzsUploadModal").modal();$("#zzsUploadModal").on("hidden.bs.modal",function(){$("#zzsUploadModal").remove();try{e.abort();c(d)}catch(p){}});function m(r,p){var q=new FormData();q.append("upload",1);q.append("file",r);e=$.ajax({url:i,type:"POST",async:true,processData:false,contentType:false,data:q,xhr:function(){var s=new XMLHttpRequest();s.upload.addEventListener("progress",function(v){var u=new Number(v.loaded/v.total);var t=(u*100).toFixed(2)+"%";$("#zzsUpProgressBar").css("width",t);$("#zzsUpProgressBar").html(t)});return s},success:function(s){d=s;++p;if(p<h.length){$("#zzsUpProgressBar").html(p/h.length*100+"%")}else{$("#zzsUpProgressBar").html(p/h.length*100+"%  上传成功!");$("#zzsUploadModal").modal("hide")}}})}};